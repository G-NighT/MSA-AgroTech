@startuml C1-alt

!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

top to bottom direction

title C1 — Платформа мониторинга скота (Cloud-first: центральный инференс, тонкий Edge)

' Акторы
Person(op, "Оператор фермы", "Реакция на события, подтверждение инцидентов")
Person(vet, "Ветврач/Зоотехник", "Анализ состояния животных")
Person(dir, "Директор хозяйства", "Сводная аналитика и KPI")
Person(analyst, "Аналитик", "Работа с BI/отчётами")
Person(mobile, "Мобильное приложение", "Уведомления, быстрые действия")

' Системы
System(central, "Центральная платформа\n(cloud-first)", "Обработка событий, кейс-логика, оповещения, хранение данных, аналитика, запуск партнёрских моделей")
System(edge, "Ферма / Edge\n(тонкий агент)", "Захват видео, буфер, шифрование, отправка в центр; локальные уведомления при офлайне")

' Внешние системы
System_Ext(cam, "IP-камеры", "RTSP/ONVIF")
System_Ext(sensors, "Датчики/актуаторы с ферм", "кормушки, поилки, фильтры воды")
System_Ext(bi, "BI/ВИ-система", "Витрины/отчёты")
System_Ext(erp, "ERP", "REST/ETL: справочники/склад")
System_Ext(notif, "Сервис уведомлений", "SMS/Email/WebPush")

' Связи внешних систем с Edge
Rel(cam, edge, "Захват Live-видео", "RTSP (LAN)")

' Связи внешних систем с центральной платформой
Rel(bi, central, "Доступ к данным/артефактам", "S3/Pre-signed")
Rel(sensors, central, "Телеметрия с ферм", "MQTT")
Rel(central, notif, "Оповещения", "HTTPS/WebPush")
Rel(central, erp, "Интеграции", "REST/ETL")

' Связи Edge с центральной платформой
Rel(edge, central, "Поток видео в центр", "WebRTC SRTP или RTMP")
Rel(edge, central, "Загрузка клипов/кадров по событию", "S3 API (pre-signed)")

' Связи акторов с Edge
Rel(edge, op, "Локальные оповещения при офлайне", "Звук/свет/SMS локального провайдера")

' Связи акторов с центральной платформой
Rel(op, central, "Веб-портал", "HTTPS")
Rel(vet, central, "Веб-портал", "HTTPS")
Rel(mobile, central, "Мобильное приложение", "HTTPS")

' Связи акторов с внешними системами
Rel(analyst, bi, "Аналитика и отчёты", "BI")
Rel(dir, bi, "Дашборды KPI", "BI")

@enduml
